# AI Context - Flipgame Project

## 🚨 ATTENZIONE - LETTURA OBBLIGATORIA PER AI ASSISTANT

**Questo file deve essere letto AUTOMATICAMENTE da qualsiasi AI che lavora su questo progetto.**

---

## 📋 CONFIGURAZIONE AUTOMATICA

### **Regole Obbligatorie**
Questo progetto segue regole SEVERE per mantenere qualità del codice. Leggi IMMEDIATAMENTE:
- **`.ai-development-rules.md`** - Regole NON negoziabili
- **`CODE_INSTRUCTIONS.md`** - Architettura tecnica obbligatoria
- **TESTING REQUIREMENTS** - Test obbligatorio su localhost:8099 prima di completare

### **Architettura Corrente**
```javascript
// ORDINE CARICAMENTO OBBLIGATORIO:
constants.js → utils.js → html-builder.js → display-manager.js → app.js → app-bridge.js
```

### **Zero Tolerance Policy**
- ❌ **ZERO duplicazioni** - MAI duplicare codice, messaggi, HTML
- ❌ **ZERO hardcoding** - Tutti i testi in `CONSTANTS.MESSAGES`
- ❌ **ZERO bypass** - SEMPRE usare utility classes esistenti

---

## 🎮 FLIPGAME PROJECT OVERVIEW

### **Game Concept**
- **Mobile-only puzzle game** with touch gestures
- **Level-based progression** - solve level to unlock next
- **Proportional rendering** - visuals scale with board size
- **Cell-based mechanics** - drag circle along permitted paths
- **No text UI** - only level numbers shown graphically

### **Technical Stack**
- **HTML5 Canvas** for game rendering
- **Touch gestures** (tap, drag) optimized with preventDefault + stopPropagation
- **CSS Grid/Flexbox** for UI layout
- **Vanilla JavaScript** for game logic
- Device pixel ratio aware canvas scaling; no external canvas library needed

### **Game Mechanics**
- **Square/Triangular lattices** for game boards
- **Path-finding puzzles** with interactive cells
- **Board transformations** (90° rotation for square, 60° for triangular)
- **Circle movement** along permitted paths
- **Level completion** when circle reaches end cell

---

## 🔧 CHECKLIST AUTOMATICA PRE-INTERVENTO

Prima di qualsiasi modifica, verifica:

### **1. Comprensione Architettura** ✓
- [ ] Ho letto `.ai-development-rules.md` completamente
- [ ] Ho verificato i requisiti di testing su localhost:8099
- [ ] Conosco l'ordine: constants.js → utils.js → html-builder.js → display-manager.js → app.js → app-bridge.js
- [ ] So quale classe usare per ogni operazione

### **2. Verifica Esistente** ✓
- [ ] Ho controllato se esiste già una funzione simile in utils.js/html-builder.js/display-manager.js
- [ ] Ho verificato se il messaggio esiste già in constants.js/CONSTANTS.MESSAGES
- [ ] Ho confermato che non sto duplicando pattern esistenti

### **3. Pattern Compliance** ✓
- [ ] Uso funzioni da `utils.js` per validazioni

- [ ] Uso funzioni da `html-builder.js` per elementi UI comuni
- [ ] Uso funzioni da `display-manager.js` per stati vuoti e liste

---

## 🎯 QUICK REFERENCE

### **Canvas Operations**
```javascript
// ✅ SEMPRE così
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
ctx.clearRect(0, 0, canvas.width, canvas.height);
```

### **Touch Event Handling**
```javascript
// ✅ SEMPRE così
canvas.addEventListener('touchstart', (e)=>{e.preventDefault();e.stopPropagation();handleTouchStart(e);}, { passive: false });
canvas.addEventListener('touchmove', (e)=>{e.preventDefault();e.stopPropagation();handleTouchMove(e);}, { passive: false });
canvas.addEventListener('touchend', (e)=>{e.preventDefault();e.stopPropagation();handleTouchEnd(e);}, { passive: false });
```

### **Level Management**
```javascript
// ✅ SEMPRE così
GameManager.loadLevel(levelNumber);
GameManager.checkLevelCompletion();
GameManager.nextLevel();
```

### **Board Transformations**
```javascript
// ✅ SEMPRE così
BoardManager.rotateBoard(degrees);
BoardManager.flipBoard();
BoardManager.resetBoard();
```

---

## ⚡ AZIONI IMMEDIATE RICHIESTE

### **Se stai lavorando su:**

#### **🔹 Nuova Funzionalità**
1. Aggiungi configurazioni in `constants.js`
2. Usa pattern esistenti nei moduli utils/html-builder/display-manager
3. Segui workflow in `.ai-development-rules.md`

#### **🔹 Modifica Esistente**
1. Verifica impact su altri componenti
2. Mantieni pattern consolidati
3. Testa TUTTE le funzionalità correlate

#### **🔹 Bug Fix**
1. Identifica root cause nell'architettura
2. Fix centralizzato nelle utility classes
3. Verifica non introduca duplicazioni

---

## 🚫 ERRORI FATALI DA EVITARE

### **❌ MAI fare questo:**
```javascript
// Hardcoding messaggi
alert('Errore durante salvataggio');

// Duplicazione validazioni
if (!name) { alert('Nome richiesto'); }

// Setup manuale modali
document.getElementById('modal-title').textContent = 'Titolo';

// Template HTML inline
const html = `<button class="btn">Click</button>`;

// Gestione manuale stati vuoti
container.innerHTML = '<div>Nessun elemento</div>';
```

### **✅ SEMPRE fare così:**
```javascript
// Usare CONSTANTS
console.error('Validation error');

// Usare Utils
Utils.validateLevelData(levelData);



// Usare HtmlBuilder
HtmlBuilder.createButton('Click', 'btn', callback);

// Usare DisplayManager
DisplayManager.renderEmptyState(container, message);
```

---

## 📞 ESCALATION

Se non sei sicuro di come procedere:
1. **Studia** `.ai-development-rules.md` più approfonditamente
2. **Analizza** pattern esistenti nel codice
3. **Chiedi conferma** invece di indovinare
4. **Proponi** soluzione seguendo architettura esistente

---

## 🎯 OBIETTIVO FINALE

**Ogni modifica deve:**
- ✅ Rispettare architettura modulare
- ✅ Usare utility classes esistenti
- ✅ Mantenere zero duplicazioni
- ✅ Seguire pattern consolidati
- ✅ Essere facilmente manutenibile
- ✅ Essere ottimizzata per mobile
- ✅ Supportare touch gestures
- ✅ Mantenere performance canvas

**Il successo si misura in: ZERO regressioni + MASSIMA consistenza + FACILITÀ estensione + MOBILE PERFORMANCE** 